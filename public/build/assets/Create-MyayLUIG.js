import{_ as N}from"./MainLayout-Cz5ClpIl.js";import{z as T,r as f,b as q,C as n,D as i,I as t,O as b,J as h,S as P,u as r,q as m,K as d,R as g,F as k,M as F,L as G,P as L,E as _,G as U,H as E}from"./vendor-core-CO7h4P2b.js";import"./Navbar-C9okvRBf.js";import"./ApplicationLogo-DfgTY2Xe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ui-DSYp2kT5.js";import"./utils-DxgFcSvi.js";const z={class:"p-6 bg-white rounded-lg shadow"},A={key:0,class:"mt-1 text-sm text-red-500"},J={key:0,class:"mt-1 text-sm text-red-500"},R={class:"flex mb-4 space-x-4"},W={key:0,class:"flex flex-wrap gap-4 mb-4"},H={key:0,class:"object-cover w-32 h-32 rounded-lg border border-gray-200",controls:""},K=["src"],O=["src"],Q=["onClick"],X={class:"text-center"},Y={class:"mt-4"},Z={class:"cursor-pointer"},ee={class:"text-blue-600 hover:text-blue-700"},te=["accept","disabled"],se={class:"mt-2 text-xs text-gray-500"},oe={class:"ml-2"},re={key:0},ae=["value"],le={key:0,class:"mt-1 text-sm text-red-500"},ne={class:"flex justify-end"},ie=["disabled"],de={__name:"CreatePost",props:{subfappId:{type:Number,required:!1},subfapps:{type:Array,required:!0}},setup(c){const s=T({title:"",content:"",subfapp_id:c.subfappId||"",images:[]}),p=f([]),y=f([]),v=f(!1),l=f("images"),x=q(()=>p.value.map((a,e)=>({url:a,type:y.value[e],index:e})).filter(a=>l.value==="images"&&a.type==="image"||l.value==="videos"&&a.type==="video")),w=a=>{const e=10-p.value.length;Array.from(a).slice(0,e).forEach(u=>{const S=["image/jpeg","image/png","image/gif","image/webp"],$=["video/mp4"];if(l.value==="images"&&!S.includes(u.type)){alert("Please upload only image files (JPG, PNG, GIF, WEBP) in the Images tab.");return}if(l.value==="videos"&&!$.includes(u.type)){alert("Please upload only MP4 files in the Videos tab.");return}if(u.size>10*1024*1024){alert(`File ${u.name} exceeds 10MB limit`);return}const C=new FileReader;C.onload=j=>{p.value.push(j.target.result),y.value.push(u.type.startsWith("video/")?"video":"image")},C.readAsDataURL(u),s.images.push(u)})},D=a=>{w(a.target.files),a.target.value=""},I=a=>{v.value=!1,w(a.dataTransfer.files)},V=a=>{p.value.splice(a,1),y.value.splice(a,1),s.images.splice(a,1)},B=()=>{s.post(route("posts.store"),{onSuccess:()=>{s.reset(),p.value=[]},forceFormData:!0})};return(a,e)=>(i(),n("div",z,[e[15]||(e[15]=t("h2",{class:"mb-4 text-2xl font-bold"},"Create a New Post",-1)),t("form",{onSubmit:g(B,["prevent"]),class:"space-y-4"},[t("div",null,[e[8]||(e[8]=t("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Title",-1)),h(t("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=o=>r(s).title=o),class:m(["block mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"border-red-500":r(s).errors.title}]),required:""},null,2),[[P,r(s).title]]),r(s).errors.title?(i(),n("p",A,d(r(s).errors.title),1)):b("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{for:"content",class:"block text-sm font-medium text-gray-700"},"Content",-1)),h(t("textarea",{id:"content","onUpdate:modelValue":e[1]||(e[1]=o=>r(s).content=o),rows:"5",class:m(["block mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"border-red-500":r(s).errors.content}]),required:""},null,2),[[P,r(s).content]]),r(s).errors.content?(i(),n("p",J,d(r(s).errors.content),1)):b("",!0)]),t("div",null,[t("div",R,[t("button",{onClick:e[2]||(e[2]=o=>l.value="images"),type:"button",class:m(["text-sm font-medium",{"text-blue-600":l.value==="images","text-gray-500":l.value!=="images"}])}," Images ",2),t("button",{onClick:e[3]||(e[3]=o=>l.value="videos"),type:"button",class:m(["text-sm font-medium",{"text-blue-600":l.value==="videos","text-gray-500":l.value!=="videos"}])}," Videos ",2)]),t("div",{class:m(["p-8 text-center rounded-lg border border-gray-300 border-dashed",{"bg-gray-50":v.value}]),onDragenter:e[4]||(e[4]=g(o=>v.value=!0,["prevent"])),onDragleave:e[5]||(e[5]=g(o=>v.value=!1,["prevent"])),onDragover:e[6]||(e[6]=g(()=>{},["prevent"])),onDrop:g(I,["prevent"])},[x.value.length>0?(i(),n("div",W,[(i(!0),n(k,null,F(x.value,o=>(i(),n("div",{key:o.index,class:"relative"},[o.type==="video"?(i(),n("video",H,[t("source",{src:o.url,type:"video/mp4"},null,8,K)])):(i(),n("img",{key:1,src:o.url,class:"object-cover w-32 h-32 rounded-lg border border-gray-200"},null,8,O)),t("button",{onClick:u=>V(o.index),type:"button",class:"absolute -top-2 -right-2 p-1 text-white bg-red-500 rounded-full hover:bg-red-600 focus:outline-none"},[...e[10]||(e[10]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Q)]))),128))])):b("",!0),t("div",X,[e[12]||(e[12]=t("svg",{class:"mx-auto w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),t("div",Y,[t("label",Z,[t("span",ee,"Upload "+d(l.value==="images"?"images":"videos"),1),t("input",{type:"file",ref:"fileInput",onChange:D,multiple:"",accept:l.value==="images"?".jpg,.jpeg,.png,.gif,.webp":".mp4",class:"hidden",disabled:p.value.length>=10},null,40,te)]),e[11]||(e[11]=t("span",{class:"text-gray-500"}," or drag and drop",-1))]),t("p",se,[G(d(l.value==="images"?"PNG, JPG, GIF, WEBP":"MP4")+" up to "+d(l.value==="images"?"5":"10")+"MB ",1),t("span",oe,"("+d(x.value.length)+"/10 files)",1)])])],34)]),c.subfappId?b("",!0):(i(),n("div",re,[e[14]||(e[14]=t("label",{for:"subfapp",class:"block text-sm font-medium text-gray-700"},"Choose Subfapp",-1)),h(t("select",{id:"subfapp","onUpdate:modelValue":e[7]||(e[7]=o=>r(s).subfapp_id=o),class:m(["block mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"border-red-500":r(s).errors.subfapp_id}]),required:""},[e[13]||(e[13]=t("option",{value:""},"Select a Subfapp",-1)),(i(!0),n(k,null,F(c.subfapps,o=>(i(),n("option",{key:o.id,value:o.id},d(o.display_name),9,ae))),128))],2),[[L,r(s).subfapp_id]]),r(s).errors.subfapp_id?(i(),n("p",le,d(r(s).errors.subfapp_id),1)):b("",!0)])),t("div",ne,[t("button",{type:"submit",class:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md border border-transparent shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:r(s).processing},d(r(s).processing?"Creating...":"Create Post"),9,ie)])],32)]))}},ue={class:"max-w-4xl mx-auto mt-8"},ye={__name:"Create",props:{subfapps:{type:Array,required:!0}},setup(c){return(M,s)=>(i(),n(k,null,[_(r(U),{title:"Create Post"}),_(N,null,{default:E(()=>[t("div",ue,[_(de,{subfapps:c.subfapps},null,8,["subfapps"])])]),_:1})],64))}};export{ye as default};
