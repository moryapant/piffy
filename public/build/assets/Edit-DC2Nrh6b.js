import{z as C,r as b,e as D,k as E,C as n,D as i,E as p,u as o,G as z,H as y,I as s,K as u,V as f,L as m,R as N,J as x,O as c,q as h,S as k,F as j,B as I}from"./vendor-core-CO7h4P2b.js";import{_ as S}from"./MainLayout-Cz5ClpIl.js";import"./utils-DxgFcSvi.js";import"./Navbar-C9okvRBf.js";import"./ApplicationLogo-DfgTY2Xe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ui-DSYp2kT5.js";const T={class:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},B={class:"bg-white dark:bg-gray-900 rounded-t-md shadow-sm border border-gray-200 dark:border-gray-700 p-4 mb-1"},V={class:"flex items-center justify-between"},A={class:"text-xl font-bold text-gray-900 dark:text-white"},H={class:"bg-white dark:bg-gray-900 rounded-b-md shadow-sm border border-gray-200 dark:border-gray-700 p-6"},M={class:"mt-1 relative rounded-md shadow-sm"},U=["value"],O={for:"display_name",class:"block text-base font-medium text-gray-900 dark:text-gray-100 mb-2"},P={key:0,class:"mt-1 text-sm text-red-500"},q={class:"ml-2 text-xs"},G={class:"flex items-start space-x-4"},R={class:"flex-shrink-0"},$={class:"h-24 w-24 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-700 flex items-center justify-center"},J=["src"],L={key:1,class:"flex items-center justify-center w-full h-full rounded-full bg-gradient-to-br from-orange-400 to-pink-500"},K={class:"text-2xl font-black text-white"},Q={class:"flex-grow pt-1"},W={for:"community-icon",class:"inline-block px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200 text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer"},X={key:0,class:"mt-1 text-sm text-red-500"},Y={class:"flex justify-between pt-6 border-t border-gray-200 dark:border-gray-700"},Z=["disabled"],ee={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ie={__name:"Edit",props:{subfapp:{type:Object,required:!0}},setup(l){const d=l,r=C({display_name:d.subfapp.display_name||"",description:d.subfapp.description||"",icon:null}),w=b(null),g=b(d.subfapp.icon?`/storage/${d.subfapp.icon}`:null);D(()=>{console.log("Form initialized:",{display_name:r.display_name,errors:r.errors,hasErrors:Object.keys(r.errors).length>0})}),E(()=>r.display_name,t=>{console.log("Display name changed:",t,"Has error:",!!r.errors.display_name),r.errors.display_name&&t&&t.trim().length>0&&(delete r.errors.display_name,console.log("Cleared display_name error"))});const v=t=>{const e=t.target.files[0];if(!e)return;if(e.size>2*1024*1024){alert("Image size should not exceed 2MB");return}console.log("File selected:",e.name,"Size:",e.size,"Type:",e.type),w.value=e,r.icon=e,r.errors.icon&&delete r.errors.icon;const a=new FileReader;a.onload=F=>{g.value=F.target.result,console.log("Icon preview created")},a.readAsDataURL(e)},_=()=>{if(console.log("Submitting form with data:",{display_name:r.display_name,description:r.description,icon:r.icon}),r.clearErrors(),r.icon){console.log("File detected, creating FormData manually. File:",r.icon.name);const t=new FormData;t.append("display_name",r.display_name||""),t.append("description",r.description||""),t.append("icon",r.icon),t.append("_method","PATCH"),I.post(route("subfapps.update",d.subfapp.id),t,{onSuccess:()=>{console.log("Form submitted successfully")},onError:e=>{console.log("Form submission errors:",e)},onFinish:()=>{console.log("Form submission finished")}})}else console.log("No file, using regular form submission"),r.patch(route("subfapps.update",d.subfapp.id),{onSuccess:()=>{console.log("Form submitted successfully")},onError:t=>{console.log("Form submission errors:",t)},onFinish:()=>{console.log("Form submission finished")}})};return(t,e)=>(i(),n(j,null,[p(o(z),{title:`Edit ${l.subfapp.display_name}`},null,8,["title"]),p(S,null,{default:y(()=>[s("div",T,[s("div",B,[s("div",V,[s("h1",A,"Edit "+u(l.subfapp.display_name),1),p(o(f),{href:t.route("subfapps.show",l.subfapp.id),class:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-full shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:y(()=>[...e[4]||(e[4]=[m(" Cancel ",-1)])]),_:1},8,["href"])])]),s("div",H,[s("form",{onSubmit:N(_,["prevent"]),class:"space-y-6"},[s("div",null,[e[6]||(e[6]=s("label",{for:"name",class:"block text-base font-medium text-gray-900 dark:text-gray-100 mb-2"},"Name",-1)),s("div",M,[e[5]||(e[5]=s("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[s("span",{class:"text-gray-500 dark:text-gray-400 sm:text-sm"},"f/")],-1)),s("input",{type:"text",id:"name",value:l.subfapp.name,class:"pl-8 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm py-3 bg-gray-50 dark:bg-gray-700",readonly:""},null,8,U)]),e[7]||(e[7]=s("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," Community names cannot be changed ",-1))]),s("div",null,[s("label",O,[e[8]||(e[8]=m(" Display Name ",-1)),Object.keys(o(r).errors).length>0?(i(),n("button",{key:0,type:"button",onClick:e[0]||(e[0]=()=>{o(r).errors={},console.log("All errors cleared manually")}),class:"ml-2 text-xs text-blue-500 hover:text-blue-700"}," Clear Errors ")):c("",!0)]),x(s("input",{type:"text",id:"display_name","onUpdate:modelValue":e[1]||(e[1]=a=>o(r).display_name=a),class:h(["block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 py-3",{"border-red-500 dark:border-red-500":o(r).errors.display_name,"border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white":!o(r).errors.display_name}]),required:"",placeholder:"Community Display Name",onInput:e[2]||(e[2]=a=>{console.log("Input event fired:",a.target.value,"Form value:",o(r).display_name,"Has error:",!!o(r).errors.display_name),o(r).errors.display_name&&a.target.value&&a.target.value.trim().length>0&&(delete o(r).errors.display_name,console.log("Error cleared via input event"))})},null,34),[[k,o(r).display_name]]),e[9]||(e[9]=s("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," This is how your community name will be shown publicly ",-1)),o(r).errors.display_name?(i(),n("p",P,[m(u(o(r).errors.display_name)+" ",1),s("span",q,"(Debug: '"+u(o(r).display_name)+"')",1)])):c("",!0)]),s("div",null,[e[12]||(e[12]=s("label",{for:"icon",class:"block text-base font-medium text-gray-900 dark:text-gray-100 mb-2"},"Community Icon",-1)),s("div",G,[s("div",R,[s("div",$,[g.value?(i(),n("img",{key:0,src:g.value,class:"h-full w-full object-cover"},null,8,J)):(i(),n("div",L,[s("span",K,u(l.subfapp.display_name[0]),1)]))])]),s("div",Q,[s("label",W,[e[10]||(e[10]=m(" Upload New Icon ",-1)),s("input",{id:"community-icon",type:"file",class:"sr-only",accept:"image/*",onChange:v},null,32)]),e[11]||(e[11]=s("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," An icon helps people recognize your community. 256x256px PNG or JPG recommended. ",-1))])])]),s("div",null,[e[13]||(e[13]=s("label",{for:"description",class:"block text-base font-medium text-gray-900 dark:text-gray-100 mb-2"},"Description",-1)),x(s("textarea",{id:"description","onUpdate:modelValue":e[3]||(e[3]=a=>o(r).description=a),rows:"4",class:h(["block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:ring-blue-500 focus:border-blue-500 py-3",{"border-red-500":o(r).errors.description}]),placeholder:"Tell people what your community is about"},null,2),[[k,o(r).description]]),e[14]||(e[14]=s("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," This is how potential members will learn about your community ",-1)),o(r).errors.description?(i(),n("p",X,u(o(r).errors.description),1)):c("",!0)]),s("div",Y,[p(o(f),{href:t.route("subfapps.show",l.subfapp.id),class:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-full shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:y(()=>[...e[15]||(e[15]=[m(" Cancel ",-1)])]),_:1},8,["href"]),s("button",{type:"submit",class:"inline-flex justify-center items-center py-2 px-6 border border-transparent shadow-sm text-sm font-medium rounded-full text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-75 disabled:cursor-not-allowed transition-all duration-200",disabled:o(r).processing},[o(r).processing?(i(),n("svg",ee,[...e[16]||(e[16]=[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):c("",!0),m(" "+u(o(r).processing?"Saving...":"Save Changes"),1)],8,Z)])],32)])])]),_:1})],64))}};export{ie as default};
